{"version":3,"file":"index.b6816199589afafab0b9.hot-update.js","sources":["webpack:///./app/graphql/PolicyDetails/services/cancelPolicy.ts","webpack:///./app/graphql/PolicyDetails/services/getExpandedPolicyDetails.ts","webpack:///./app/graphql/PolicyDetails/services/getHistoryForPolicyRelatedActions.ts","webpack:///./app/graphql/Reports/services/getLandlordsDataForReports.ts","webpack:///./app/graphql/Reports/services/getReportsDetails.ts","webpack:///./app/graphql/SearchPolicies/services/getHistory.ts","webpack:///./app/graphql/SearchPolicies/services/getPolicySearchTypes.ts","webpack:///./app/graphql/SearchPolicies/services/getPolicyStatuses.ts","webpack:///./app/graphql/SearchPolicies/services/getSearchPolicies.ts","webpack:///./app/server/server.ts"],"sourcesContent":["import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport type { CancelPolicyResponse } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst cancelPolicy = async (\n  policyId: string,\n  caseNumber: string,\n  note: string,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<CancelPolicyResponse | null> => {\n  const response = await axios\n    .post(\n      `${api.gql.cancelPolicy}`,\n      {\n        policyId: policyId,\n        caseNumber: caseNumber,\n        note: note,\n        userToken: rentGuaranteeUserToken,\n      },\n      {\n        headers: {\n          Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n        },\n      },\n    )\n    .then((res) => res.data)\n    .catch((err) => {\n      log.error(`Network error cancelling policy for policyId: ${policyId}: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'cancelPolicy failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'cancelPolicy viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(cancelPolicy);\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport type { PolicyDetails } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getExpandedPolicyDetails = async (\n  policyId: string,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<PolicyDetails | null> => {\n  const response = await axios\n    .get(`${api.gql.expandedPolicyDetails}?policyId=${policyId}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching policy for policyId: ${policyId}: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getExpandedPolicyDetails failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'getExpandedPolicyDetails viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getExpandedPolicyDetails);\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport type { HistoryForPolicyRelatedActions } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getHistoryForPolicyRelatedActions = async (\n  policyId: string,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<HistoryForPolicyRelatedActions | null> => {\n  const response = await axios\n    .get(`${api.gql.historyForPolicyRelatedActions}?policyId=${policyId}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching history for policy related actions for for policyId: ${policyId}: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getHistoryForPolicyRelatedActions failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'getHistoryForPolicyRelatedActions viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getHistoryForPolicyRelatedActions);\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport type { Landlords } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getLandlordsDataForReports = async (\n  methodToInvoke: string,\n  urlParams: string | undefined | null,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<Landlords | null> => {\n  let url = `${process.env.API}/rent-guarantee/api/v1/admin/${methodToInvoke}`;\n  if (urlParams && urlParams?.length > 0) {\n    url = `${url}?${urlParams}`;\n  }\n\n  const response = await axios\n    .get(`${url}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching Landlords ${methodToInvoke} report: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'landlordsReports failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'landlordsReports viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getLandlordsDataForReports);\n","import axios from 'axios';\nimport { api } from '../../utils/api';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport type { Reports } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getReportsDetails = async (\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<Reports | null> => {\n  const response = await axios\n    .get(`${api.gql.reports}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching reports: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getHistoryForPolicyRelatedActions failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'getExpandedPolicyDetails viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getReportsDetails);\n","import type { LogIdType } from './../../../../shared/generated-types/graphql';\nimport axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport type { History } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getHistory = async (\n  searchType: LogIdType,\n  searchValue: string,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<History | null> => {\n  const response = await axios\n    .get(`${api.gql.history}?logIdType=${searchType}&logIdValue=${searchValue}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching history for searchValue: ${searchValue}: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getHistory failed', amount: 1 });\n      return null;\n    });\n\n  // Increment a count:\n  await nodeMonitor.increment({ name: 'getHistory viewed', amount: 1 });\n\n  return response;\n};\n\nexport default tracer.wrap(getHistory);\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport type { PolicySearchTypes } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getPolicySearchTypes = async (\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<PolicySearchTypes | null> => {\n  const response = await axios\n    .get(`${api.gql.policySearchTypes}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching policy for policy search types: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getPolicySearchTypes failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'getPolicySearchTypes viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getPolicySearchTypes);\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport type { PolicyStatuses } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getPolicyStatuses = async (\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<PolicyStatuses | null> => {\n  const response = await axios\n    .get(`${api.gql.policyStatuses}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching policy statuses search types: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getPolicyStatuses failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'getPolicyStatuses viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getPolicyStatuses);\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport { api } from '../../utils/api';\nimport { buildPoliciesFromResponse } from '../PoliciesBuilder';\nimport type { Policies } from '../../../../shared/generated-types/graphql';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getSearchPolicies = async (\n  searchType: string,\n  searchValue: string,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<Policies | null> => {\n  const response = await axios\n    .get(`${api.gql.searchPolicies}?searchType=${searchType}&searchValue=${searchValue}`, {\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res) => res.data.data)\n    .catch((err) => {\n      log.error(`Network error fetching policy for ${searchType}: ${searchValue}: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'getSearchPolicies failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'getSearchPolicies viewed', amount: 1 });\n    return buildPoliciesFromResponse(response);\n  }\n\n  return null;\n};\n\nexport default tracer.wrap(getSearchPolicies);\n","import type { Logger } from '@zg-rentals/particles-js-base-logger';\nimport type { PinoLogger } from '@zg-rentals/particles-js-node-logger';\nimport express from 'express';\nimport cookieParser from 'cookie-parser';\nimport { getHttpLogger } from '@zg-rentals/particles-js-node-logger';\nimport cors from 'cors';\n\nimport monitorMiddleware from './middleware/nodeMonitor';\nimport log from './utils/log';\nimport createHealthcheck from './middleware/healthcheck';\nimport { tracer } from './utils/tracer';\n\n// GraphQL\nimport { ApolloServer } from 'apollo-server-express';\nimport schema from '../graphql/federatedSchema';\n\nconst step = log.child('server') as Logger;\n\nstep.warn('running server');\n\nconst server = new ApolloServer({\n  schema,\n  context: ({ req }) => {\n    const token = req.cookies;\n\n    return {\n      token,\n    };\n  },\n  introspection: __DEV__,\n  playground: __DEV__,\n});\n\n// Express\nconst app = express();\nconst healthcheck = createHealthcheck(log.child('healthcheck') as Logger);\n\nconst httpLogger = getHttpLogger({\n  logger: (log as PinoLogger).logger,\n});\n\n// must bind 'this' because of JS\nmonitorMiddleware(app);\n\ntracer.traceApp(app);\n\nif (__DEV__) {\n  const corsOptions = {\n    // @ts-ignore expect-any\n    origin: (origin, callback) => {\n      callback(null, origin);\n    },\n    credentials: true,\n  };\n  app.use(cors(corsOptions));\n}\n\napp.use(cookieParser());\napp.use(httpLogger);\napp.use(`*/check`, tracer.wrap(healthcheck.check as (...args: Array<unknown>) => unknown, 'healthcheck'));\napp.use(`*/shutdown`, healthcheck.shutdown);\napp.get(`/`, (req, res) => {\n  step.warn(req.cookies, 'Cookies');\n  res.writeHead(200, { 'Content-Type': 'text/html' });\n  res.write(`Rent Guarantee Express Server Response!`);\n  res.end();\n});\n\ntracer.errorMiddleware();\n\n// Express error handler - catches any express error uncaught by a middleware function\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\napp.use((err: any, req: unknown, res: { status: (arg0: number) => void }, next: () => void) => {\n  log.error(err);\n  res.status(500);\n  next();\n});\n\nserver.applyMiddleware({ app, path: '/rent-guarantee-graphql/graphql', cors: false });\n\nexport default app;\n"],"mappings":"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","sourceRoot":""}