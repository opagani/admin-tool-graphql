{"version":3,"file":"index.0e0b1339d592c3cc3dcb.hot-update.js","sources":["webpack:///./app/graphql/PolicyDetails/resolvers.ts","webpack:///./app/graphql/Reports/resolvers.ts","webpack:///./app/graphql/Reports/services/getUserActivityDataForReports.ts","webpack:///./app/graphql/SearchPolicies/resolvers.ts"],"sourcesContent":["import type { ResolverFn } from '../../types/ResolversFn';\nimport type {\n  CancelPolicyResponse,\n  HistoryForPolicyRelatedActions,\n  MutationCancelPolicyArgs,\n  PolicyDetails,\n  QueryExpandedPolicyDetailsArgs,\n  QueryHistoryForPolicyRelatedActionsArgs,\n} from '../../../shared/generated-types/graphql';\nimport { policyDetailsServices } from './services';\n\nexport type RentGuaranteeContext = {\n  token: { 'rent-guaranteeUserToken': string; 'rent-guaranteeSessionToken': string };\n};\n\nexport type PolicyResolver<Query> = ResolverFn<Query, RentGuaranteeContext>;\n\nconst expandedPolicyDetails: PolicyResolver<QueryExpandedPolicyDetailsArgs> = async (\n  _parent: unknown,\n  { policyId }: QueryExpandedPolicyDetailsArgs,\n  context: RentGuaranteeContext,\n): Promise<PolicyDetails | null> => {\n  return await policyDetailsServices.getExpandedPolicyDetails(\n    policyId,\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst historyForPolicyRelatedActions: PolicyResolver<QueryHistoryForPolicyRelatedActionsArgs> = async (\n  _parent: unknown,\n  { policyId }: QueryHistoryForPolicyRelatedActionsArgs,\n  context: RentGuaranteeContext,\n): Promise<HistoryForPolicyRelatedActions | null> => {\n  return await policyDetailsServices.getHistoryForPolicyRelatedActions(\n    policyId,\n    context?.token?.['rent-guaranteeUserToken'],\n    context?.token?.['rent-guaranteeSessionToken'],\n  );\n};\n\nconst cancelPolicy: PolicyResolver<MutationCancelPolicyArgs> = async (\n  _parent: unknown,\n  { policyId, caseNumber, note }: MutationCancelPolicyArgs,\n  context: RentGuaranteeContext,\n): Promise<CancelPolicyResponse | null> => {\n  return await policyDetailsServices.cancelPolicy(\n    policyId,\n    caseNumber,\n    note,\n    context?.token?.['rent-guaranteeUserToken'],\n    context?.token?.['rent-guaranteeSessionToken'],\n  );\n};\n\nconst policyDetailsQueryResolvers = {\n  expandedPolicyDetails,\n  historyForPolicyRelatedActions,\n};\n\nconst policyDetailsMutationResolvers = {\n  cancelPolicy,\n};\n\nconst policyDetailsResolvers = {\n  Query: policyDetailsQueryResolvers,\n  Mutation: policyDetailsMutationResolvers,\n};\n\nexport default policyDetailsResolvers;\n","import type { ResolverFn } from '../../types/ResolversFn';\nimport type {\n  Landlords,\n  QueryLandlordsDataForReportsArgs,\n  QueryReportsArgs,\n  Reports,\n  UserActivities,\n} from '../../../shared/generated-types/graphql';\nimport { reportsServices } from './services';\nimport type { QueryUserActivityDataForReportsArgs } from '../../../shared/generated-types/graphql';\n\nexport type RentGuaranteeContext = {\n  token: { 'rent-guaranteeUserToken': string; 'rent-guaranteeSessionToken': string };\n};\n\nexport type ReportResolver<Query> = ResolverFn<Query, RentGuaranteeContext>;\n\nconst reports: ReportResolver<QueryReportsArgs> = async (\n  _parent: unknown,\n  { reportType }: QueryReportsArgs,\n  context: RentGuaranteeContext,\n): Promise<Reports | null | unknown> => {\n  return await reportsServices.getReportsDetails(\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n    reportType || '',\n  );\n};\n\nconst landlordsDataForReports: ReportResolver<QueryLandlordsDataForReportsArgs> = async (\n  _parent: unknown,\n  { methodToInvoke, urlParams }: QueryLandlordsDataForReportsArgs,\n  context: RentGuaranteeContext,\n): Promise<Landlords | null | unknown> => {\n  return await reportsServices.getLandlordsDataForReports(\n    methodToInvoke,\n    urlParams,\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst userActivityDataForReports: ReportResolver<QueryUserActivityDataForReportsArgs> = async (\n  _parent: unknown,\n  { methodToInvoke, urlParams }: QueryUserActivityDataForReportsArgs,\n  context: RentGuaranteeContext,\n): Promise<UserActivities | null | unknown> => {\n  return await reportsServices.getUserActivityDataForReports(\n    methodToInvoke,\n    urlParams || null,\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst reportsQueryResolvers = {\n  reports,\n  landlordsDataForReports,\n  userActivityDataForReports,\n};\n\nconst reportsResolvers = {\n  Query: reportsQueryResolvers,\n};\n\nexport default reportsResolvers;\n","import axios from 'axios';\nimport log from '../../../server/utils/log';\nimport { tracer } from '../../../server/utils/tracer';\nimport type {\n  Activities,\n  ListingActivity,\n  Maybe,\n  UrlParams,\n  UserActivity,\n} from '../../../../shared/generated-types/graphql';\nimport type { QueryParams } from '../../../graphql/utils/utils';\nimport { utils } from '../../../graphql/utils/utils';\nimport nodeMonitor from '../../../server/utils/nodeMonitor';\n\nconst getUserActivityDataForReports = async (\n  methodToInvoke: string,\n  urlParams: Maybe<Array<Maybe<UrlParams>>>,\n  rentGuaranteeUserToken: string,\n  rentGuaranteeSessionToken: string,\n): Promise<Activities | null> => {\n  const url = `${process.env.API}/rent-guarantee/api/v1/admin/${methodToInvoke}`;\n  const queryParams: QueryParams = utils.generateQueryParams(urlParams);\n  const response = await axios\n    .get(`${url}`, {\n      params: queryParams,\n      headers: {\n        Cookie: `rent-guaranteeUserToken=${rentGuaranteeUserToken}; rent-guaranteeSessionToken=${rentGuaranteeSessionToken}`,\n      },\n    })\n    .then((res): Activities | null => {\n      switch (methodToInvoke) {\n        case 'getUserActivityAllEvents':\n        case 'getUserActivityOptIns':\n          if (res) {\n            return {\n              __typename: 'Activities',\n              userActivities: convertToActivity(res?.data?.data?.logs || []),\n            };\n          }\n          return null;\n        default:\n          return null;\n      }\n    })\n    .catch((err) => {\n      log.error(`Network error fetching user activity ${methodToInvoke} report: ${err}`);\n      // Log an error (using the class instance's logger):\n      nodeMonitor.increment({ name: 'userActivityReports failed', amount: 1 });\n      return null;\n    });\n\n  if (response) {\n    // Increment a count:\n    await nodeMonitor.increment({ name: 'userActivityReports viewed', amount: 1 });\n    return response;\n  }\n\n  return null;\n};\n\nconst convertToActivity = (\n  activities: Array<UserActivity | ListingActivity>,\n): Array<UserActivity | ListingActivity> => {\n  return activities.map((activity: UserActivity | ListingActivity): UserActivity | ListingActivity => {\n    return { ...activity, __typename: activity.idType == 'listingAlias' ? 'ListingActivity' : 'UserActivity' };\n  });\n};\n\nexport default tracer.wrap(getUserActivityDataForReports);\n","import type { ResolverFn } from '../../types/ResolversFn';\nimport type {\n  History,\n  Policies,\n  PolicySearchTypes,\n  PolicyStatuses,\n  QueryHistoryArgs,\n  QuerySearchPoliciesArgs,\n} from '../../../shared/generated-types/graphql';\nimport { searchPoliciesServices } from './services';\n\nexport type RentGuaranteeContext = {\n  token: { 'rent-guaranteeUserToken': string; 'rent-guaranteeSessionToken': string };\n};\n\nexport type SearchPoliciesResolver<Query> = ResolverFn<Query, RentGuaranteeContext>;\n\nconst searchPolicies: SearchPoliciesResolver<QuerySearchPoliciesArgs> = async (\n  _parent: unknown,\n  { searchType, searchValue }: QuerySearchPoliciesArgs,\n  context: RentGuaranteeContext,\n): Promise<Policies | null> => {\n  return await searchPoliciesServices.getSearchPolicies(\n    searchType,\n    searchValue,\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst history: SearchPoliciesResolver<QueryHistoryArgs> = async (\n  _parent: unknown,\n  { logIdType, logIdValue }: QueryHistoryArgs,\n  context: RentGuaranteeContext,\n): Promise<History | null> => {\n  return await searchPoliciesServices.getHistory(\n    logIdType,\n    logIdValue,\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst policySearchTypes: SearchPoliciesResolver<unknown> = async (\n  _parent: unknown,\n  _vars: unknown,\n  context: RentGuaranteeContext,\n): Promise<PolicySearchTypes | null> => {\n  return await searchPoliciesServices.getPolicySearchTypes(\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst policyStatuses: SearchPoliciesResolver<unknown> = async (\n  _parent: unknown,\n  _vars: unknown,\n  context: RentGuaranteeContext,\n): Promise<PolicyStatuses | null> => {\n  return await searchPoliciesServices.getPolicyStatuses(\n    context?.token?.['rent-guaranteeUserToken'] || '',\n    context?.token?.['rent-guaranteeSessionToken'] || '',\n  );\n};\n\nconst searchPoliciesQueryResolvers = {\n  searchPolicies,\n  history,\n  policySearchTypes,\n  policyStatuses,\n};\n\nconst searchPoliciesResolvers = {\n  Query: searchPoliciesQueryResolvers,\n};\n\nexport default searchPoliciesResolvers;\n"],"mappings":"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","sourceRoot":""}